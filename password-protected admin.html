<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Protected Contact Submissions</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
  th { background-color: #f2f2f2; }
  #login { max-width: 300px; margin: 50px auto; text-align: center; }
  #login input { width: 100%; padding: 10px; margin: 5px 0; }
</style>
</head>
<body>

<div id="login">
  <h2>Enter Password</h2>
  <input type="password" id="password" placeholder="Password">
  <button onclick="checkPassword()">Submit</button>
  <p id="error" style="color:red; display:none;">Wrong password!</p>
</div>

<div id="content" style="display:none;">
  <h1>Contact Form Submissions</h1>
  <table id="submissions">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Subject</th>
        <th>Message</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr><td colspan="5">Loading submissions...</td></tr>
    </tbody>
  </table>
</div>

<script>
  const correctPassword = "Banggi123"; // তোমার password বসাও
  const siteId = "8b77ce44-5452-44e5-8ab6-0334c91db951";
  const accessToken = "nfp_95KHgPnno2V5ZsiFESpeuKyVpiQws29W61a6";
  const formName = "contact";

  function checkPassword() {
    const input = document.getElementById("password").value;
    if(input === correctPassword) {
      document.getElementById("login").style.display = "none";
      document.getElementById("content").style.display = "block";
      loadSubmissions();
    } else {
      document.getElementById("error").style.display = "block";
    }
  }

  function loadSubmissions() {
    fetch(`https://api.netlify.com/api/v1/sites/${siteId}/forms/${formName}/submissions`, {
      headers: { "Authorization": `Bearer ${accessToken}` }
    })
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#submissions tbody");
      tbody.innerHTML = "";
      if(data.length === 0){
        tbody.innerHTML = "<tr><td colspan='5'>No submissions yet.</td></tr>";
      } else {
        data.forEach(msg => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${msg.data.name || ""}</td>
            <td>${msg.data.email || ""}</td>
            <td>${msg.data.subject || ""}</td>
            <td>${msg.data.message || ""}</td>
            <td>${new Date(msg.submitted_at).toLocaleString()}</td>
          `;
          tbody.appendChild(row);
        });
      }
    })
    .catch(err => {
      const tbody = document.querySelector("#submissions tbody");
      tbody.innerHTML = `<tr><td colspan='5'>Error loading submissions: ${err}</td></tr>`;
    });
  }
</script>

</body>
</html>
